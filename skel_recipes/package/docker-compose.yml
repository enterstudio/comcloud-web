# Common services

## PacketFence
packetfence:
  extends:
    file: ./services/packetfence/compose.yml
    service: packetfence
    # ports:
    # do not exposes ports because uses the native network stack. Configuration portal is on: https://ip:1443

casserver:
  extends:
    file: ./services/cas/compose.yml
    service: cas
  ports:
    - "8080:8080"
    - "8443:8443"

## CorpPortal
corpportal-web:
  extends:
    file: ./services/corpportal/compose.yml
    service: corpportal-web
  ports:
    - "80:9000"
    - "35729:35729"
  links:
    - corpportal-db:db
    - casserver
  environment:
    - APP_OWNCLOUD=true
    - APP_ZIMBRA=true
    - APP_REDMINE=true
    - APP_OPENFIRE=true
    - MASTER_FQDN=FQDN_HERE

  volumes:
    - ./data/company-logo.png:/usr/src/app/client/assets/images/logo.png:ro

corpportal-db:
  extends:
    file: ./services/corpportal/compose.yml
    service: corpportal-db

# Specific services

## Owncloud
owncloud:
  build: services/owncloud
  links: 
    - casserver
  ports:
    - "8081:80"
  hostname: HOST_HERE
  domainname: DOMAIN_HERE

# Zimbra
zimbra:
  build: services/zimbra
  links: 
    - casserver
  ports:
    - "8082:443"
    - "7071:7071"
  environment:
    - PASSWORD=docker
  hostname: HOST_HERE
  domainname: DOMAIN_HERE

# Redmine
redmine:
  build: services/redmine
  links: 
    - casserver
  ports:
    - "8083:3000"
  hostname: HOST_HERE
  domainname: DOMAIN_HERE

# Jabber
#openfire:
#  build: services/openfire
#  links: 
#    - casserver
#  ports:
#    - "9090:9090"
#    - "9091:9091"
#    - "5222:5222"
#    - "5223:5223"
#    - "7072:7070"
#    - "7777:7777"
#    - "7443:7443"
#    - "5229:5229"
#    - "5269:5269"
#  hostname: HOST_HERE
#  domainname: DOMAIN_HERE
#
#sparkweb:
#  build: services/sparkweb
#  links:
#    - openfire
#  ports:
#    - "8084:80"
#  hostname: HOST_HERE
#  domainname: DOMAIN_HERE

kaiwa-server:
  build: services/kaiwa-server
  hostname: HOST_HERE
  domainname: DOMAIN_HERE
  ports:
    - "5222:5222"
    - "5269:5269"
    - "5280:5280"
    - "5281:5281"
    - "3478:3478/udp"
  links:
    - casserver

kaiwa-client:
  build: services/kaiwa-client
  hostname: HOST_HERE
  domainname: DOMAIN_HERE
  links:
    - kaiwa-server
  ports:
    - "8084:8084"   # Reserved for web
